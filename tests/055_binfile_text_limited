#!/bin/sh
# SPDX-FileCopyrightText: 2025 Frank Hunleth
# SPDX-FileCopyrightText: 2025 Lars Wikman
#
# SPDX-License-Identifier: Apache-2.0

#
# Read text serial number from a binary file and limit the output
#

# Create a simulated factory data binary with text serial number at offset 88
xxd -r - $WORK/factory_data <<EOF
00000000: 2446 4121 0000 0000 0100 0000 0000 0000  \$FA!............
00000010: 0000 0000 0000 0000 0000 0000 0000 0000  ................
00000020: 1122 3344 5566 7788 99aa bbcc ddee ff00  ."3DUfw.........
00000030: 0000 0000 0000 0000 4445 5653 4e31 3233  ........DEVSN123
00000040: 3435 3600 0000 0000 0000 0000 0000 0000  456.............
00000050: 0000 0000 0000 0000 424f 4152 4453 4e31  ........BOARDSN1
00000060: 3233 3435 3600 0000 0000 0000 0000 0000  23456...........
00000070: 0000 0000 0000 0000 0000 0000 0000 0000  ................
EOF

CMDLINE="-b binfile -t text -f /factory_data -l 32 -k 88 -n 4"

cat >$EXPECTED <<EOF
3456
EOF
